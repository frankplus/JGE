#ifndef _JGE_H_
#define _JGE_H_

#include <stdio.h>
#include <stdlib.h>
#include <string>
#include <stdarg.h>

#include "JTypes.h"


bool JGEGetButtonState(u32 button);
bool JGEGetButtonClick(u32 button);
u8 JGEGetAnalogX();
u8 JGEGetAnalogY();
void JGEGetMouseMovement(int *x, int *y);
std::string JGEGetTextInput();

#include "Vector2D.h"

class JApp;
class JFileSystem;
class JMotionSystem;
class JMusic;

//////////////////////////////////////////////////////////////////////////
/// Game engine main interface.
//////////////////////////////////////////////////////////////////////////
class JGE
{
private:
	JApp *mApp;

	float mDeltaTime;

	JMusic *mCurrentMusic;

	bool mDone;

	float mDelta;

	bool mDebug;
	
	bool mPaused;

	char mDebuggingMsg[256];

	bool mCriticalAssert;
	const char *mAssertFile;
	int mAssertLine;


	static JGE* mInstance;

public:

	bool mClicked;

	//////////////////////////////////////////////////////////////////////////
	/// Get JGE instance.
	///
	/// @return JGE instance.
	//////////////////////////////////////////////////////////////////////////
	static JGE* GetInstance();
	static void Destroy();

	void Init();
	void Run();
	void End();

	void Update();
	void Render();

	void Pause();
	void Resume();

	//////////////////////////////////////////////////////////////////////////
	/// Return elapsed time since last frame update.
	///
	/// @return Elapsed time in seconds.
	//////////////////////////////////////////////////////////////////////////
	float GetDelta();

	//////////////////////////////////////////////////////////////////////////
	/// Return frame rate.
	///
	/// @note This is just 1.0f/GetDelat().
	///
	/// @return Number of frames per second.
	//////////////////////////////////////////////////////////////////////////
	float GetFPS();

	//////////////////////////////////////////////////////////////////////////
	/// Check the current state of a button.
	///
	/// @param button - Button id.
	///
	/// @return Button state.
	//////////////////////////////////////////////////////////////////////////
	bool GetButtonState(u32 button);

	//////////////////////////////////////////////////////////////////////////
	/// Check if a button is down the first time.
	///
	/// @param button - Button id.
	///
	/// @return Button state.
	//////////////////////////////////////////////////////////////////////////
	bool GetButtonClick(u32 button);

	//////////////////////////////////////////////////////////////////////////
	/// Get x value of the analog pad.
	///
	/// @return X value (0 to 255).
	//////////////////////////////////////////////////////////////////////////
	u8 GetAnalogX();

	//////////////////////////////////////////////////////////////////////////
	/// Get y value of the analog pad.
	///
	/// @return Y value (0 to 255).
	//////////////////////////////////////////////////////////////////////////
	u8 GetAnalogY();

	//////////////////////////////////////////////////////////////////////////
	/// Get relative mouse movement since previous time this is called
	///
	/// @param x - pointer for x 
	/// @param y - pointer for y 
	//////////////////////////////////////////////////////////////////////////
	void GetMouseMovement(int *x, int *y);

	//////////////////////////////////////////////////////////////////////////
	/// Get characters typed since last update
	///
	/// @return text typed in input
	//////////////////////////////////////////////////////////////////////////
	std::string GetTextInput();

	//////////////////////////////////////////////////////////////////////////
	/// Get if the system is ended or not.
	///
	/// @return Status of the system.
	//////////////////////////////////////////////////////////////////////////
	bool IsDone() { return mDone; }
	

	//////////////////////////////////////////////////////////////////////////
	/// Set the user's core application class.
	///
	/// @param app - User defined application class.
	//////////////////////////////////////////////////////////////////////////
	void SetApp(JApp *app);

	//////////////////////////////////////////////////////////////////////////
	/// Set time delta since last update in seconds
	///
	/// @param delta - delta time in seconds
	//////////////////////////////////////////////////////////////////////////
	void SetDelta(float delta);

protected:
	JGE();
	~JGE();


};


#endif
